"use strict";var X=Object.create;var j=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,oe=Object.prototype.hasOwnProperty;var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ne=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of te(t))!oe.call(e,s)&&s!==r&&j(e,s,{get:()=>t[s],enumerable:!(o=ee(t,s))||o.enumerable});return e};var q=(e,t,r)=>(r=e!=null?X(re(e)):{},ne(t||!e||!e.__esModule?j(r,"default",{value:e,enumerable:!0}):r,e));var A=T((Re,se)=>{se.exports={name:"dotenv",version:"16.6.1",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=text --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},homepage:"https://github.com/motdotla/dotenv#readme",funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var B=T((_e,p)=>{"use strict";var N=require("fs"),b=require("path"),ae=require("os"),ie=require("crypto"),ce=A(),D=ce.version,ue=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function de(e){let t={},r=e.toString();r=r.replace(/\r\n?/mg,`
`);let o;for(;(o=ue.exec(r))!=null;){let s=o[1],n=o[2]||"";n=n.trim();let a=n[0];n=n.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),a==='"'&&(n=n.replace(/\\n/g,`
`),n=n.replace(/\\r/g,"\r")),t[s]=n}return t}function le(e){e=e||{};let t=K(e);e.path=t;let r=c.configDotenv(e);if(!r.parsed){let a=new Error(`MISSING_DATA: Cannot parse ${t} for an unknown reason`);throw a.code="MISSING_DATA",a}let o=P(e).split(","),s=o.length,n;for(let a=0;a<s;a++)try{let i=o[a].trim(),l=fe(r,i);n=c.decrypt(l.ciphertext,l.key);break}catch(i){if(a+1>=s)throw i}return c.parse(n)}function pe(e){console.log(`[dotenv@${D}][WARN] ${e}`)}function w(e){console.log(`[dotenv@${D}][DEBUG] ${e}`)}function $(e){console.log(`[dotenv@${D}] ${e}`)}function P(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function fe(e,t){let r;try{r=new URL(t)}catch(i){if(i.code==="ERR_INVALID_URL"){let l=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw l.code="INVALID_DOTENV_KEY",l}throw i}let o=r.password;if(!o){let i=new Error("INVALID_DOTENV_KEY: Missing key part");throw i.code="INVALID_DOTENV_KEY",i}let s=r.searchParams.get("environment");if(!s){let i=new Error("INVALID_DOTENV_KEY: Missing environment part");throw i.code="INVALID_DOTENV_KEY",i}let n=`DOTENV_VAULT_${s.toUpperCase()}`,a=e.parsed[n];if(!a){let i=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${n} in your .env.vault file.`);throw i.code="NOT_FOUND_DOTENV_ENVIRONMENT",i}return{ciphertext:a,key:o}}function K(e){let t=null;if(e&&e.path&&e.path.length>0)if(Array.isArray(e.path))for(let r of e.path)N.existsSync(r)&&(t=r.endsWith(".vault")?r:`${r}.vault`);else t=e.path.endsWith(".vault")?e.path:`${e.path}.vault`;else t=b.resolve(process.cwd(),".env.vault");return N.existsSync(t)?t:null}function k(e){return e[0]==="~"?b.join(ae.homedir(),e.slice(1)):e}function me(e){let t=!!(e&&e.debug),r=e&&"quiet"in e?e.quiet:!0;(t||!r)&&$("Loading env from encrypted .env.vault");let o=c._parseVault(e),s=process.env;return e&&e.processEnv!=null&&(s=e.processEnv),c.populate(s,o,e),{parsed:o}}function ve(e){let t=b.resolve(process.cwd(),".env"),r="utf8",o=!!(e&&e.debug),s=e&&"quiet"in e?e.quiet:!0;e&&e.encoding?r=e.encoding:o&&w("No encoding is specified. UTF-8 is used by default");let n=[t];if(e&&e.path)if(!Array.isArray(e.path))n=[k(e.path)];else{n=[];for(let m of e.path)n.push(k(m))}let a,i={};for(let m of n)try{let u=c.parse(N.readFileSync(m,{encoding:r}));c.populate(i,u,e)}catch(u){o&&w(`Failed to load ${m} ${u.message}`),a=u}let l=process.env;if(e&&e.processEnv!=null&&(l=e.processEnv),c.populate(l,i,e),o||!s){let m=Object.keys(i).length,u=[];for(let O of n)try{let E=b.relative(process.cwd(),O);u.push(E)}catch(E){o&&w(`Failed to load ${O} ${E.message}`),a=E}$(`injecting env (${m}) from ${u.join(",")}`)}return a?{parsed:i,error:a}:{parsed:i}}function ge(e){if(P(e).length===0)return c.configDotenv(e);let t=K(e);return t?c._configVault(e):(pe(`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`),c.configDotenv(e))}function he(e,t){let r=Buffer.from(t.slice(-64),"hex"),o=Buffer.from(e,"base64"),s=o.subarray(0,12),n=o.subarray(-16);o=o.subarray(12,-16);try{let a=ie.createDecipheriv("aes-256-gcm",r,s);return a.setAuthTag(n),`${a.update(o)}${a.final()}`}catch(a){let i=a instanceof RangeError,l=a.message==="Invalid key length",m=a.message==="Unsupported state or unable to authenticate data";if(i||l){let u=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw u.code="INVALID_DOTENV_KEY",u}else if(m){let u=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw u.code="DECRYPTION_FAILED",u}else throw a}}function ye(e,t,r={}){let o=!!(r&&r.debug),s=!!(r&&r.override);if(typeof t!="object"){let n=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw n.code="OBJECT_REQUIRED",n}for(let n of Object.keys(t))Object.prototype.hasOwnProperty.call(e,n)?(s===!0&&(e[n]=t[n]),o&&w(s===!0?`"${n}" is already defined and WAS overwritten`:`"${n}" is already defined and was NOT overwritten`)):e[n]=t[n]}var c={configDotenv:ve,_configVault:me,_parseVault:le,config:ge,decrypt:he,parse:de,populate:ye};p.exports.configDotenv=c.configDotenv;p.exports._configVault=c._configVault;p.exports._parseVault=c._parseVault;p.exports.config=c.config;p.exports.decrypt=c.decrypt;p.exports.parse=c.parse;p.exports.populate=c.populate;p.exports=c});var x=q(require("express")),z=q(B()),Z=require("http");var S=require("zod"),we=function(t,r,o,s){return t instanceof S.ZodError?o.status(400).json({error:"Erro de valida\xE7\xE3o",issues:t.format()}):t.status&&t.message?o.status(t.status).json({error:t.message}):(console.error("Erro inesperado:",t),o.status(500).json({error:"Erro interno no servidor"}))},Y=we;var G=require("express");var L=require("express");var V=require("zod");var v=require("zod"),I=v.z.object({name:v.z.string().min(1,"Name is required"),description:v.z.string().optional(),price:v.z.number().positive(),category:v.z.string().min(1),favorite:v.z.boolean().optional(),imageUrl:v.z.string().url().optional()});var F=require("@prisma/client"),h=new F.PrismaClient;var d={create:async e=>await h.product.create({data:e}),findAll:async()=>await h.product.findMany(),findById:async e=>await h.product.findUnique({where:{id:e}}),update:async(e,t)=>await h.product.update({where:{id:e},data:t}),delete:async e=>await h.product.delete({where:{id:e}}),findFavorites:async()=>await h.product.findMany({where:{favorite:!0}})};var f={create:async e=>{try{let t=I.parse(e);return await d.create(t)}catch(t){throw t instanceof V.ZodError?{status:400,message:"Erro de valida\xE7\xE3o",issues:t.issues}:t}},findAll:async()=>await d.findAll(),findById:async e=>{let t=await d.findById(e);if(!t)throw{status:404,message:"Produto n\xE3o encontrado"};return t},update:async(e,t)=>{try{let r=I.parse(t);if(!await d.findById(e))throw{status:404,message:"Produto n\xE3o encontrado"};return await d.update(e,r)}catch(r){throw r instanceof V.ZodError?{status:400,message:"Erro de valida\xE7\xE3o",issues:r.issues}:r}},delete:async e=>{if(!await d.findById(e))throw{status:404,message:"Produto n\xE3o encontrado"};return await d.delete(e)},favorite:async(e,t)=>{let r=await d.findById(e);if(!r)throw{status:404,message:"Produto n\xE3o encontrado"};let o=t??!r.favorite,s={...r,favorite:o,description:r.description??void 0,imageUrl:r.imageUrl??void 0};return await d.update(e,s)},findFavorites:async()=>await d.findFavorites()};var y={create:async(e,t)=>{let r=await f.create(e.body);return t.status(201).json(r)},findAll:async(e,t)=>{let r=await f.findAll();return t.json(r)},findById:async(e,t)=>{let r=await f.findById(Number(e.params.id));return t.json(r)},update:async(e,t)=>{let r=await f.update(Number(e.params.id),e.body);return t.json(r)},delete:async(e,t)=>{let r=await f.delete(Number(e.params.id));return t.status(204).send()},favorite:async(e,t)=>{let r=await f.favorite(Number(e.params.id),e.body?.favorite);return t.json(r)}};var g=(0,L.Router)();g.post("/new",y.create);g.get("/",y.findAll);g.get("/:id",y.findById);g.put("/:id",y.update);g.delete("/:id",y.delete);g.patch("/:id",y.favorite);g.get("/healthProducts",(e,t)=>{t.send("Health Products check is OK!")});var U=g;var M=require("express");var C={findFavorites:async(e,t)=>{let r=await f.findFavorites();return t.json(r)}};var W=(0,M.Router)();W.get("/favorites",C.findFavorites);var H=W;var R=(0,G.Router)();R.get("/",(e,t)=>{t.send("Welcome to the API!")});R.use("/products",U);R.use("/lists",H);var J=R;z.default.config();var _=(0,x.default)(),Ee=(0,Z.createServer)(_);_.use(x.default.json());_.use("/",J);_.use(Y);var Q=process.env.PORT||3e3;Ee.listen(Q,()=>{console.log(`Server is running on http://localhost:${Q}`)});
